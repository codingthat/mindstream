<div class="header">
  <div class="title">{{ title }}</div>
</div>
<form [formGroup]="form" class="page">
  <label class="field-label">
    Task
  </label>
  <input
    #taskTextField
    type="text"
    formControlName="text"
    class="field"
  >
  <label class="field-label">
    Projects
  </label>
  <input
    #taskProjectsField
    type="text"
    formControlName="projects"
    class="field"
    (focus)="showProjectSuggestions()"
    (input)="showProjectSuggestions()"
    (blur)="hideProjectSuggestions()"
    (keydown)="selectProject($event)"
  >
  <ul class="project-list">
    <li
      *ngFor="let project of getFilteredProjects()"
      class="project"
      [class.selected]="project === selectedProject"
      (click)="addProject(project)"
    >{{ project }}</li>
  </ul>

  <label class="field-label">
    Contexts
  </label>
  <input
    type="text"
    formControlName="contexts"
    class="field"
  >

  <label class="field-label">
    Priority
  </label>
  <div class="field-wrapper">
    <input
      type="text"
      formControlName="priority"
      class="field"
    >
    <div
      *ngFor="let priority of priorities; let last = last;"
      class="field-addon"
    >
      <a
        (click)="setPriority(priority)"
        [className]="'priority priority-' + priority.toLowerCase()"
      >
        {{ priority }}
      </a>
    </div>
  </div>

  <label class="field-label">Due date</label>
  <div id="due-date-wrapper" class="field-wrapper">
    <input
      type="text"
      formControlName="dueDate"
      class="field"
    >
    <a (click)="setDueToday()" class="field-addon">today</a>
    <span class="field-addon">|</span>
    <a (click)="setDueTomorrow()" class="field-addon">tomorrow</a>
    <span class="field-addon">|</span>
    <span
      angular-mydatepicker
      #datepicker="angular-mydatepicker"
      [options]="{
        dateFormat: 'yyyy-mm-dd',
        alignSelectorRight: true,
        stylesData: {
          styles: '
            .myDpSelector {left: auto !important; right: 0}
            .myDpSelectorArrowRight::before,
            .myDpSelectorArrowRight::after {left: 93%}
            .myDpDaycell, .myDpWeekDayTitle {color: #643900}
            .myDpMarkCurrDay {border-color: #643900}
            .myDpSelectedDay {background-color: #ebebeb}
          '
        }
      }"
    ></span>
    <a
      (click)="showDatePicker(datepicker)"
      id="calendar-icon"
      class="field-addon material-icons event"
    ></a>
  </div>

  <label class="field-label">Recurrence</label>
  <input
    type="text"
    formControlName="recurrence"
    class="field"
  >

  <button
    type="button"
    [disabled]="!form.valid"
    (click)="save()"
    id="save-btn"
    class="btn"
  >
    save
  </button>
</form>
